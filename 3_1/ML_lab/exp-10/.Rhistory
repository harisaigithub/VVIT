library(dplyr)
library(ggplot2)
library(cluster)
head(mtcars)
distance_mat<-dist(mtcars,method='euclidean')
distance_mat
Hierar_cl<-hclust(distance_mat,method="average")
plot(Hierar_cl)
num_clusters<-3
fit<-cutree(Hierar_cl,k=num_clusters)
fit
#Display count of data points in each cluster
table(fit)
#highlight the clusters on dendogram
rect.hclust(Hierar_cl,k=num_clusters,border="green")
clustered_data<-data.frame(mtcars,Cluster=factor(fit))
custom_colors<-c("red","blue","yellow")
scatterplot<-ggplot(clustered_data,aes(x=mpg,
y=disp,
color=Cluster))+
geom_point(size=3)+
geom_text(aes(label=Cluster),hjust=0,vjust=0,
nudge_x=1,nudge_y=20,size=4)+
labs(x="Miles per gallon (mpg)",y="Displacement(disp",
title="Scatterplot of clusters with custom colors")+
scale_color_manual(values=custom_colors,name="Clusters")
scatterplot
cluster_means<-clustered_data%>%
group_by(Cluster)%>%
summarise(mean_mpg=mean(mpg))
bar_graph<-ggplot(cluster_means,aes(x=Cluster,y = mean_mpg, fill = Cluster))+
geom_bar(stat="identity",position="dodge")+
geom_text(aes(label=round(mean_mpg,2),
y=mean_mpg+0.5),vjust=-0.5,
position=position_dodge(width=0.9))+
labs(x="Cluster",y="miles per gallon (mpg)",
title="Bar graphs of miles per gallon (mpg) by clusters")+
scale_fill_manual(values=custom_colors,name="Cluster")+
theme_minimal()
print(bar_graph)
